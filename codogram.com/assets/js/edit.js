var RM=0,fr=$('.f-err');$(document).on('click','a',function(e){if(RM!==0){Materialize.toast('Please wait until your data is saved!',5000,'indigo lighten-1');EP(e)}});$(W).ready(function(){$("#sortable").sortable();var CO=$(".step-blocks #code");jQuery.each(CO,function(k,v){var editor=ace.edit(v);editor.setTheme("ace/theme/clouds");editor.setFontSize("14px");editor.setOptions({enableBasicAutocompletion:true,enableSnippets:true,enableLiveAutocompletion:false,minLines:15,wrap:true,maxLines:100});editor.getSession().setMode("ace/mode/html");});$('#update-main').submit(function(e){EP(e);if(RM===0){RM=1;loader_start();$('#main-btn').prop('disabled',true);var T=$(this);$.ajax({type:'post',url:'/ajax/edit-tutorial.php',dataType:'json',data:T.serialize()+'&token='+$('#ajaxToken').val(),success:function(r){loader_end();RM=0;if(r.error){fr.addClass('red-text');fr.removeClass('black-text');$('#one-err').text(r.error);}else if(r.success){Materialize.toast(r.success,5000,'indigo lighten-1');fr.removeClass('red-text');fr.addClass('black-text');$('#one-err').text(r.success)}$('#main-btn').prop('disabled',false);fr.fadeIn(setTimeout(function(){fr.fadeOut();},2000))}})}});$('.steps').submit(function(e){EP(e);if(RM===0){RM=1;loader_start();var T=$(this),V=T.attr('data-id'),Q=T.find("#code");code='';jQuery.each(Q,function(k,v){editor=ace.edit(v);code=encodeURIComponent(editor.getSession().getValue())});$('.parts-btn').prop('disabled',true);$.ajax({type:'post',url:'/ajax/edit-tutorial.php',dataType:'json',data:T.serialize()+'&token='+$('#ajaxToken').val()+'&ID='+V+'&code='+code,success:function(r){loader_end();RM=0;$('.parts-btn').prop('disabled',false);if(r.error){fr.addClass('red-text');fr.removeClass('black-text');$('#err'+V).text(r.error)}else if(r.success){Materialize.toast(r.success,5000,'indigo lighten-1');fr.removeClass('red-text');fr.addClass('black-text');$('#err'+V).text(r.success)}fr.fadeIn(setTimeout(function(){fr.fadeOut();},2000))}})}});$('.m-btn').click(function(){var T=$(this);var nv=T.next().val();$('#tzid').val(nv)});$('.modal-trigger').leanModal({dismissible:true,complete:function(){$('#tzid').val('')}});$('.remove-block').click(function(e){if(RM===0){$('.remove-block').text('Wait...');RM=1;var T=$(this);$.ajax({type:'post',url:'/ajax/remove_step.php',dataType:'json',data:'token='+$('#ajaxToken').val()+'&id='+T.next().val(),success:function(r){RM=0;if(r.error){$('#modal1').closeModal();$('#err'+T.next().val()).text(r.error);$('.remove-block').text('Confirm Remove');fr.fadeIn(setTimeout(function(){fr.fadeOut();},5000))}if(r.success){location.reload()}}})}});$('#fc-pos').submit(function(e){EP(e);if(RM===0){RM=1;loader_start();var T=$(this);$('.pos-btn').prop('disabled',true);$.ajax({type:'post',url:'/ajax/edit-tutorial.php',data:T.serialize()+'&token='+$('#ajaxToken').val(),dataType:'json',success:function(r){RM=0;loader_end();if(r.error){$('.pos-btn').prop('disabled',false);$('.f-err2').fadeIn();$('#pos-err').text(r.error)}if(r.success){$('#pos-err').text('Positions Changed Successfully');$('.f-err2').fadeIn(setTimeout(function(){$('.f-err2').fadeOut();location.reload()},2000))}}})}});$('#fc-pos').change(function(){$('.pos-btn').prop('disabled',false)});$('.remove-tut').click(function(){if(RM===0){RM=1;loader_start();var T=$(this);T.prop('disabled',true);$.ajax({type:'post',url:'/ajax/edit-tutorial.php',data:'rt_id='+T.attr('data-id')+'&token='+$('#ajaxToken').val(),success:function(r){loader_end();$('.a-d').fadeIn(setTimeout(function(){location.href='/'},2000));}})}})});