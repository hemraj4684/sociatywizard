$(document).ready(function(){pw_i=0;$('.pw-reset').click(function(e){PD(e);if(pw_i===0){if(confirm("Are you sure?\nA new password will be sent as SMS to this member.")){pw_i=1;t=$(this);page_loader();$.get(URL+'registeredmembersform/reset_password/'+t.data('id')).complete(function(){pw_i=0;page_loader_exit()}).success(function(){Materialize.toast('Done! A New Password Has Been Sent.',3000,'green success-area')})}}});$('.new_flat_btn').click(function(){++last_key;$('.flat_of tbody').append('<tr><td><input name="flat_id[]" type="hidden" value="0"><input type="text" class="flat_float"><div class="drop_here_f_'+last_key+'"></div></td><td><input type="radio" name="ot['+last_key+']" id="owner_'+last_key+'" value="1" checked><label for="owner_'+last_key+'">Owner</label> &nbsp;&nbsp; <input type="radio" name="ot['+last_key+']" id="tenant_'+last_key+'" value="2"><label for="tenant_'+last_key+'">Tenant</label></td><td><button type="button" class="btn red accent-4 flat_remove btn-small"><i class="fa fa-close m0"></i></button></td></tr>')});$('#flats_info_form').submit(function(e){PD(e);t=$(this);$('.submit-btn').prop('disabled',true);$('.submit-btn').html('<i class="fa fa-spinner fa-pulse"></i> Saving....');$.ajax({type:'post',url:URL+'registeredmembersform/flats_info_update',data:t.serialize(),dataType:'json',complete:function(){$('.submit-btn').prop('disabled',false);$('.submit-btn').html('<i class="fa fa-save left"></i> Save Changes')},success:function(res){if(res.success){Materialize.toast('<i class="fa fa-thumbs-o-up"></i> &nbsp; Changes Saved Successfully',3000,'green success-area')}if(res.error){$('.res').text(res.error)}else{$('.res').text('')}}})});$('#edit-user-form').submit(function(e){PD(e);t=$(this);$('.submit-btn').prop('disabled',true);$('.submit-btn').html('<i class="fa fa-spinner fa-pulse"></i> Saving....');$.ajax({type:'post',url:URL+'registeredmembersform/edit',data:t.serialize(),dataType:'json',complete:function(){$('.submit-btn').prop('disabled',false);$('.submit-btn').html('<i class="fa fa-save left"></i> Save Changes');},success:function(r){if(r.success){location.reload()}else{$('.form-success').html('');}if(r.fn){$('.fn-err').html(r.fn)}else{$('.fn-err').html('')}if(r.ln){$('.ln-err').html(r.ln);}else{$('.ln-err').html('');}if(r.em){$('.em-err').html(r.em)}else{$('.em-err').html('')}if(r.mo){$('.mo-err').html(r.mo)}else{$('.mo-err').html('')}if(r.flat){$('.flat-err').html(r.flat)}else{$('.flat-err').html('')}if(r.status){$('.status').html(r.status)}else{$('.status').html('')}if(r.mem_type){$('.mem-type').html(r.mem_type)}else{$('.mem-type').html('')}if(r.user_id){$('.user_id').html(r.user_id)}else{$('.user_id').html('')}if(r.de){$('.de_err').text(r.de)}else{$('.de_err').text('')}}})})});$(d).on('click','.flat_remove',function(){$(this).parents('tr').remove()});ff_v=0;$(document).on('keyup','.flat_float',function(){if(ff_v===0){ff_v=1;t=$(this);t.prop('disabled',true);$.ajax({type:'post',data:'var='+t.val()+'&user_token='+token,url:URL+'flatsform/search_flat_keyword',complete:function(){t.prop('disabled',false);t.focus();ff_v=0},success:function(res){t.next().html(res)}})}});$(d).on('click','.drop-f-item',function(){t=$(this);inp=t.parents('td').find('.flat_float');inp.val(t.data('value'));inp.prev().val(t.data('id'));inp.next().html('')})